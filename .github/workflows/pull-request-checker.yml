name: PR Checker

on:
  pull_request:
    branches:
      - docs-staging
      - master
    types: [opened, reopened, labeled]

jobs:

  initial-comment:
    name: Initial comment
    runs-on: ubuntu-latest

    steps:
      - name: Add initial comment w/ instructions
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          header: Initial comment
          message: |
            Initial message INSERT MESSAGE HERE using markdown

  review-labels:
    name: Check for missing review label
    runs-on: ubuntu-latest

    steps:
      - name: Review Label Check
        id: prefix_label_check
        uses: docker://agilepathway/pull-request-label-checker:latest
        with:
          prefix_mode: true
          one_of: "needs review by"
          repo_token: ${{ secrets.GITHUB_TOKEN }}
      - name: Missing Review Label Comment PR
        if: failure()
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          header: Review label missing
          message: |
            Missing review INSERT MESSAGE HERE using markdown
          
  release-labels:
    name: Check for missing release label
    runs-on: ubuntu-latest

    steps:
      - id: prefix_label_check
        uses: docker://agilepathway/pull-request-label-checker:latest
        with:
          prefix_mode: true
          one_of: "release:"
          repo_token: ${{ secrets.GITHUB_TOKEN }}
      - name: Missing Release Label Comment PR
        if: failure()
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          header: Release label missing
          message: |
            Missing release INSERT MESSAGE HERE using markdown

  area-labels:
    name: Check for missing area label
    runs-on: ubuntu-latest

    steps:
      - id: prefix_label_check
        uses: docker://agilepathway/pull-request-label-checker:latest
        with:
          prefix_mode: true
          one_of: "area:"
          repo_token: ${{ secrets.GITHUB_TOKEN }}
      - name: Missing Area Label Comment PR
        if: failure()
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          header: Area label missing
          message: |
            Missing area INSERT MESSAGE HERE using markdown
    